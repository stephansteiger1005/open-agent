version: "3.8"

services:
  # MCP Server - Provides two demo tools with constant JSON data
  mcp-server:
    build:
      context: .
      dockerfile: Dockerfile.mcp
    container_name: demo-mcp-server
    restart: unless-stopped
    stdin_open: true
    tty: true

  # OpenWebUI - Chat interface with MCP integration
  openwebui:
    image: ghcr.io/open-webui/open-webui:main
    container_name: demo-openwebui
    ports:
      - "3000:8080"
    environment:
      # Disable authentication for demo
      - WEBUI_AUTH=false
      
      # No external models - using tools only
      - ENABLE_OPENAI_API=false
      - ENABLE_OLLAMA_API=false
      
      # User preconfiguration
      - DEFAULT_USER_ROLE=admin
      - ENABLE_SIGNUP=false
      
      # MCP Configuration
      - ENABLE_MCP=true
      - MCP_SERVERS=demo-mcp-server
    volumes:
      - openwebui_data:/app/backend/data
    depends_on:
      - mcp-server
    restart: unless-stopped

volumes:
  openwebui_data:
